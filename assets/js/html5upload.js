(function(e){e.fn.html5Uploader=function(t){function n(e){var t=new FileReader;t.onabort=function(t){o.onClientAbort&&o.onClientAbort(t,e)},t.onerror=function(t){o.onClientError&&o.onClientError(t,e)},t.onload=function(t){o.onClientLoad&&o.onClientLoad(t,e)},t.onloadend=function(t){o.onClientLoadEnd&&o.onClientLoadEnd(t,e)},t.onloadstart=function(t){o.onClientLoadStart&&o.onClientLoadStart(t,e)},t.onprogress=function(t){o.onClientProgress&&o.onClientProgress(t,e)},t.readAsDataURL(e);var n=new XMLHttpRequest;n.upload.onabort=function(t){o.onServerAbort&&o.onServerAbort(t,e)},n.upload.onerror=function(t){o.onServerError&&o.onServerError(t,e)},n.upload.onload=function(t){o.onServerLoad&&o.onServerLoad(t,e)},n.upload.onloadstart=function(t){o.onServerLoadStart&&o.onServerLoadStart(t,e)},n.upload.onprogress=function(t){o.onServerProgress&&o.onServerProgress(t,e)},n.onreadystatechange=function(t){o.onServerReadyStateChange&&o.onServerReadyStateChange(t,e,n.readyState),o.onSuccess&&n.readyState==4&&n.status==200&&o.onSuccess(t,e,n.responseText)},n.open("POST",o.postUrl,!0);if(e.getAsBinary){var u=s+i+r+"Content-Disposition: form-data;"+'name="'+o.name+'";'+'filename="'+unescape(encodeURIComponent(e.name))+'"'+r+"Content-Type: application/octet-stream"+r+r+e.getAsBinary()+r+s+i+s;n.setRequestHeader("Content-Type","multipart/form-data;boundary="+i),n.sendAsBinary(u)}else if(window.FormData){var a=new FormData;a.append(o.name,e),n.send(a)}}var r="\r\n",i="iloveigloo",s="--",o={name:"uploadedFile",postUrl:"Upload.aspx",onClientAbort:null,onClientError:null,onClientLoad:null,onClientLoadEnd:null,onClientLoadStart:null,onClientProgress:null,onServerAbort:null,onServerError:null,onServerLoad:null,onServerLoadStart:null,onServerProgress:null,onServerReadyStateChange:null,onSuccess:null};return t&&e.extend(o,t),this.each(function(t){var r=e(this);r.is("[type='file']")?r.bind("change",function(){var e=this.files;for(var t=0;t<e.length;t++)n(e[t])}):r.bind("dragenter dragover",function(){return e(this).addClass("hover"),!1}).bind("dragleave",function(){return e(this).removeClass("hover"),!1}).bind("drop",function(t){e(this).removeClass("hover");var r=t.originalEvent.dataTransfer.files;for(var i=0;i<r.length;i++)n(r[i]);return!1})})}})(jQuery)